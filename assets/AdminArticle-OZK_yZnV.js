import{a as b}from"./axios-L6U4YIEh.js";import{M as y}from"./bootstrap.esm-TTjMTX3M.js";import{S as h}from"./sweetalert2.all-7pLa5uUz.js";import{p as $}from"./PaginationComponents-rQEmwqd9.js";import{_ as M,o as c,c as n,b as t,t as p,bC as r,bs as m,bo as V,F as f,aV as P,d as A,e as g,r as v}from"./index-iKm-APML.js";import"./_commonjsHelpers-1J56E-h6.js";const C={props:["isNew","tempArticle","updateArticle"],data(){return{modalArticle:null,editArticle:{},create_at:""}},watch:{tempArticle(){this.editArticle=this.tempArticle;const o=new Date(this.editArticle.create_at*1e3).toISOString().split("T");[this.create_at]=o},create_at(){this.editArticle.create_at=Math.floor(new Date(this.create_at)/1e3)}},methods:{openModal(){this.modalArticle.show()},closeModal(){this.modalArticle.hide()}},mounted(){this.modalArticle=new y(this.$refs.articleModal),this.editArticle=this.tempArticle}},D={id:"articleModal",ref:"articleModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},T={class:"modal-dialog modal-xl"},U={class:"modal-content border-0"},E={class:"modal-header bg-dark text-white"},L={id:"productModalLabel",class:"modal-title"},S={key:0},N={key:1},I=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),R={class:"modal-body"},B={class:"row"},F={class:"col-sm-8"},O={class:"mb-3"},j=t("label",{for:"title",class:"form-label"},"標題",-1),H={class:"row"},q={class:"mb-3 col-md-6"},z=t("label",{for:"author",class:"form-label"},"作者",-1),G={class:"mb-3 col-md-6"},J=t("label",{for:"create_at",class:"form-label"},"文章建立日期",-1),K={class:"mb-3"},Q=t("label",{for:"description",class:"form-label"},"文章描述",-1),W=t("label",{for:"description",class:"form-label"},"文章內容",-1),X={class:"mb-3"},Y={class:"form-check"},Z=t("label",{class:"form-check-label",for:"isPublic"},"是否公開",-1),tt={class:"modal-footer"},et=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function lt(o,e,i,w,l,d){return c(),n("div",D,[t("div",T,[t("div",U,[t("div",E,[t("h5",L,[i.isNew?(c(),n("span",S,"新增文章")):(c(),n("span",N,"編輯文章"))]),I]),t("div",R,[t("div",B,[t("pre",null,"    "+p(i.tempArticle)+`
    `,1),t("div",F,[t("div",O,[j,r(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[0]||(e[0]=s=>l.editArticle.title=s)},null,512),[[m,l.editArticle.title]])]),t("div",H,[t("div",q,[z,r(t("input",{id:"percent",type:"text",min:"0",class:"form-control",placeholder:"請輸入作者","onUpdate:modelValue":e[1]||(e[1]=s=>l.editArticle.author=s)},null,512),[[m,l.editArticle.author]])]),t("div",G,[J,r(t("input",{id:"create_at",type:"date",class:"form-control",placeholder:"文章建立日期","onUpdate:modelValue":e[2]||(e[2]=s=>l.create_at=s)},null,512),[[m,l.create_at]])])]),t("div",K,[Q,r(t("textarea",{type:"text",class:"form-control",id:"description","onUpdate:modelValue":e[3]||(e[3]=s=>l.editArticle.description=s),placeholder:"請輸入文章描述"},null,512),[[m,l.editArticle.description]])]),W,r(t("textarea",{type:"text",class:"form-control",id:"description","onUpdate:modelValue":e[4]||(e[4]=s=>l.editArticle.content=s),placeholder:"請輸入文章內容"},null,512),[[m,l.editArticle.content]]),t("div",X,[t("div",Y,[r(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=s=>l.editArticle.isPublic=s),id:"isPublic"},null,512),[[V,l.editArticle.isPublic]]),Z])])])])]),t("div",tt,[et,t("button",{type:"button",class:"btn btn-primary",onClick:e[6]||(e[6]=(...s)=>i.updateArticle&&i.updateArticle(...s))}," 確認 ")])])])],512)}const st=M(C,[["render",lt]]);var ot={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_PATH:"junapi",BASE_URL:"/Aromatherapy-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:u,VITE_PATH:_}=ot,it={data(){return{articles:[],tempArticle:{},pages:{},modalProduct:null,modalDel:null,isNew:!1}},methods:{getArticle(o=1){const e=`${u}/api/${_}/admin/articles?page=${o}`;b.get(e).then(i=>{this.articles=i.data.articles,this.pages=i.data.pagination}).catch(i=>{h.fire(i.response.data.message)})},openModal(o,e){o==="new"?(this.tempArticle={create_at:new Date().getTime()/1e3},this.isNew=!0,this.$refs.pModal.openModal()):o==="edit"?(this.tempArticle={...e},this.isNew=!1,this.$refs.pModal.openModal()):o==="delete"&&(this.tempArticle={...e},this.modalDel.show())},updateArticle(){let o=`${u}/api/${_}/admin/article`,e="post";this.isNew||(o=`${u}/api/${_}/admin/article/${this.tempArticle.id}`,e="put"),b[e](o,{data:this.tempArticle}).then(i=>{h.fire(i.data.message),this.getArticle(),this.$refs.pModal.closeModal(),this.tempArticle={}}).catch(i=>{h.fire(i.response.data.message)})},delArticle(){const o=`${u}/api/${_}/admin/article/${this.tempArticle.id}`;b.delete(o).then(e=>{h.fire(e.data.message),this.modalDel.hide(),this.getArticle()}).catch(e=>{h.fire(e.response.data.message)})}},mounted(){this.getArticle(),this.modalDel=new y(this.$refs.delProductModal)},components:{pagination:$,articleModal:st}},at={class:"container"},dt={class:"text-end mt-4"},ct={class:"table mt-4"},nt=t("thead",null,[t("tr",null,[t("th",{width:"120"},"標題"),t("th",{width:"80"},"作者"),t("th",{width:"80"},"建立時間"),t("th",{width:"200"},"內容描述"),t("th",{width:"80"},"是否上傳"),t("th",{width:"80"}," 編輯 ")])],-1),rt={key:0,class:"text-success"},pt={key:1},ht={class:"btn-group"},mt=["onClick"],ut=["onClick"],_t={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},bt={class:"modal-dialog"},ft={class:"modal-content border-0"},At=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除優惠卷")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),gt={class:"modal-body"},vt={class:"text-danger"},yt={class:"modal-footer"},Mt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function wt(o,e,i,w,l,d){const s=v("pagination"),x=v("article-modal");return c(),n(f,null,[t("div",at,[t("div",dt,[t("button",{class:"btn btn-primary",style:{"background-color":"#7FA185"},onClick:e[0]||(e[0]=a=>d.openModal("new"))}," 建立新文章 ")]),t("table",ct,[nt,t("tbody",null,[(c(!0),n(f,null,P(l.articles,a=>(c(),n("tr",{key:a.id},[t("td",null,p(a.title),1),t("td",null,p(a.author),1),t("td",null,p(a.create_at),1),t("td",null,p(a.description),1),t("td",null,[a.isPublic?(c(),n("span",rt,"已上傳")):(c(),n("span",pt,"未上傳"))]),t("td",null,[t("div",ht,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:k=>d.openModal("edit",a)}," 編輯 ",8,mt),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:k=>d.openModal("delete",a)}," 刪除 ",8,ut)])])]))),128))])]),A(s,{pages:l.pages,"get-article":d.getArticle},null,8,["pages","get-article"])]),A(x,{"temp-article":l.tempArticle,"update-article":d.updateArticle,ref:"pModal"},null,8,["temp-article","update-article"]),t("div",_t,[t("div",bt,[t("div",ft,[At,t("div",gt,[g(" 是否刪除 "),t("strong",vt,p(l.tempArticle.title),1),g(" 商品(刪除後將無法恢復)。 ")]),t("div",yt,[Mt,t("button",{type:"button",class:"btn btn-danger",onClick:e[1]||(e[1]=(...a)=>d.delArticle&&d.delArticle(...a))}," 確認刪除 ")])])])],512)],64)}const Dt=M(it,[["render",wt]]);export{Dt as default};
