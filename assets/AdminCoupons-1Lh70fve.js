import{a as b,S as u}from"./sweetalert2.all-9OAsj1rz.js";import{M as y}from"./bootstrap.esm-TTjMTX3M.js";import{p as x}from"./PaginationComponents-qPndmfBB.js";import{_ as M,o as i,c as p,b as o,i as c,v as r,G as V,F as C,g as D,d as f,e as g,t as _,r as v}from"./index-w6KDmUW0.js";const T={props:["isNew","tempCoupons","updateCoupons"],data(){return{modalCoupons:null,editCoupons:{},due_date:""}},watch:{tempCoupons(){this.editCoupons=this.tempCoupons;const s=new Date(this.editCoupons.due_date*1e3).toISOString().split("T");[this.due_date]=s},due_date(){this.editCoupons.due_date=Math.floor(new Date(this.due_date)/1e3)}},methods:{openModal(){this.modalCoupons.show()},closeModal(){this.modalCoupons.hide()}},mounted(){this.modalCoupons=new y(this.$refs.couponsModal),this.editCoupons=this.tempCoupons}},E={id:"couponsModal",ref:"couponsModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},L={class:"modal-dialog modal-xl"},S={class:"modal-content border-0"},U={class:"modal-header bg-dark text-white"},N={id:"productModalLabel",class:"modal-title"},A={key:0},I={key:1},P=o("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),R={class:"modal-body"},B={class:"row"},O={class:"col-sm-8"},j={class:"mb-3"},F=o("label",{for:"title",class:"form-label"},"標題",-1),H={class:"row"},G={class:"mb-3 col-md-6"},q=o("label",{for:"percent",class:"form-label"},"折扣",-1),z={class:"mb-3 col-md-6"},J=o("label",{for:"due_date",class:"form-label"},"到期日",-1),K={class:"mb-3 col-md-6"},Q=o("label",{for:"code",class:"form-label"},"優惠碼",-1),W={class:"mb-3"},X={class:"form-check"},Y=o("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),Z={class:"modal-footer"},oo=o("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function to(s,t,n,w,e,a){return i(),p("div",E,[o("div",L,[o("div",S,[o("div",U,[o("h5",N,[n.isNew?(i(),p("span",A,"新增產品")):(i(),p("span",I,"編輯產品"))]),P]),o("div",R,[o("div",B,[o("div",O,[o("div",j,[F,c(o("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":t[0]||(t[0]=d=>e.editCoupons.title=d)},null,512),[[r,e.editCoupons.title]])]),o("div",H,[o("div",G,[q,c(o("input",{id:"percent",type:"number",min:"0",class:"form-control",placeholder:"請輸入折扣","onUpdate:modelValue":t[1]||(t[1]=d=>e.editCoupons.percent=d)},null,512),[[r,e.editCoupons.percent,void 0,{number:!0}]])]),o("div",z,[J,c(o("input",{id:"due_date",type:"date",class:"form-control",placeholder:"請輸入到期日","onUpdate:modelValue":t[2]||(t[2]=d=>e.due_date=d)},null,512),[[r,e.due_date]])])]),o("div",K,[Q,c(o("input",{id:"code",type:"text",class:"form-control",placeholder:"請輸入優惠碼","onUpdate:modelValue":t[3]||(t[3]=d=>e.editCoupons.code=d)},null,512),[[r,e.editCoupons.code]])]),o("div",W,[o("div",X,[c(o("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":t[4]||(t[4]=d=>e.editCoupons.is_enabled=d)},null,512),[[V,e.editCoupons.is_enabled]]),Y])])])])]),o("div",Z,[oo,o("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=(...d)=>n.updateCoupons&&n.updateCoupons(...d))}," 確認 ")])])])],512)}const eo=M(T,[["render",to]]);var so={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_PATH:"junapi",BASE_URL:"/Aromatherapy-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:m,VITE_PATH:h}=so,no={data(){return{coupons:[],tempCoupons:{},pages:{},modalCoupons:null,modalDel:null,isNew:!1}},methods:{getCoupons(s=1){const t=`${m}/api/${h}/admin/coupons?page=${s}`;b.get(t).then(n=>{this.coupons=n.data.coupons,this.pages=n.data.pagination}).catch(n=>{u.fire(n.response.data.message)})},openModal(s,t){s==="new"?(this.tempCoupons={due_date:new Date().getTime()/1e3},this.isNew=!0,this.$refs.pModal.openModal()):s==="edit"?(this.tempCoupons={...t},this.isNew=!1,this.$refs.pModal.openModal()):s==="delete"&&(this.tempCoupons={...t},this.modalDel.show())},updateCoupons(){let s=`${m}/api/${h}/admin/coupon`,t="post";this.isNew||(s=`${m}/api/${h}/admin/coupon/${this.tempCoupons.id}`,t="put"),b[t](s,{data:this.tempCoupons}).then(n=>{u.fire(n.data.message),this.getCoupons(),this.$refs.pModal.closeModal(),this.tempCoupons={}}).catch(n=>{u.fire(n.response.data.message)})},delCoupons(){const s=`${m}/api/${h}/admin/coupon/${this.tempCoupons.id}`;b.delete(s).then(t=>{u.fire(t.data.message),this.modalDel.hide(),this.getCoupons()}).catch(t=>{u.fire(t.response.data.message)})}},mounted(){this.getCoupons(),this.modalDel=new y(this.$refs.delCouponsModal)},components:{pagination:x,couponsModal:eo}},lo={class:"container"},ao={class:"text-end mt-4"},io={class:"table mt-4"},po=o("thead",null,[o("tr",null,[o("th",{width:"120"},"優惠名稱"),o("th",{width:"120"},"折扣"),o("th",{width:"120"},"到期日"),o("th",{width:"150"},"是否啟用"),o("th",{width:"80"},"編輯")])],-1),uo={key:0,class:"text-success"},co={key:1},ro={class:"btn-group"},_o=["onClick"],mo=["onClick"],ho={id:"delCouponsModal",ref:"delCouponsModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},bo={class:"modal-dialog"},Co={class:"modal-content border-0"},fo=o("div",{class:"modal-header bg-danger text-white"},[o("h5",{id:"delProductModalLabel",class:"modal-title"},[o("span",null,"刪除優惠卷")]),o("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),go={class:"modal-body"},vo={class:"text-danger"},yo={class:"modal-footer"},Mo=o("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function wo(s,t,n,w,e,a){const d=v("pagination"),$=v("coupons-modal");return i(),p(C,null,[o("div",lo,[o("div",ao,[o("button",{class:"btn btn-primary",style:{"background-color":"#7fa185"},onClick:t[0]||(t[0]=l=>a.openModal("new"))}," 建立新的優惠卷 ")]),o("table",io,[po,o("tbody",null,[(i(!0),p(C,null,D(e.coupons,l=>(i(),p("tr",{key:l.id},[o("td",null,_(l.title),1),o("td",null,_(l.percent),1),o("td",null,_(l.due_date),1),o("td",null,[l.is_enabled?(i(),p("span",uo,"啟用")):(i(),p("span",co,"未啟用"))]),o("td",null,[o("div",ro,[o("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:k=>a.openModal("edit",l)}," 編輯 ",8,_o),o("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:k=>a.openModal("delete",l)}," 刪除 ",8,mo)])])]))),128))])]),f(d,{pages:e.pages,"get-coupons":a.getCoupons},null,8,["pages","get-coupons"])]),f($,{"temp-coupons":e.tempCoupons,"update-coupons":a.updateCoupons,ref:"pModal"},null,8,["temp-coupons","update-coupons"]),o("div",ho,[o("div",bo,[o("div",Co,[fo,o("div",go,[g(" 是否刪除 "),o("strong",vo,_(e.tempCoupons.title),1),g(" 商品(刪除後將無法恢復)。 ")]),o("div",yo,[Mo,o("button",{type:"button",class:"btn btn-danger",onClick:t[1]||(t[1]=(...l)=>a.delCoupons&&a.delCoupons(...l))}," 確認刪除 ")])])])],512)],64)}const Do=M(no,[["render",wo]]);export{Do as default};
