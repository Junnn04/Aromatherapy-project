import{a as c}from"./axios-L6U4YIEh.js";import{M as C}from"./bootstrap.esm-TTjMTX3M.js";import{S as i}from"./sweetalert2.all-7pLa5uUz.js";import{p as y}from"./PaginationComponents-lO9seOh2.js";import{_ as M,c as d,b as t,F as u,aV as g,d as w,e as f,t as l,r as $,o as n,J as v}from"./index-2gzOPHIY.js";import"./_commonjsHelpers-1J56E-h6.js";var x={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_PATH:"junapi",BASE_URL:"/Aromatherapy-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:h,VITE_PATH:m}=x,P={data(){return{orders:[],tempCoupons:{},pages:{},modalProduct:null,modalDel:null,isNew:!1}},methods:{getOrder(s=1){const e=`${h}/api/${m}/admin/orders?page=${s}`;c.get(e).then(o=>{this.orders=o.data.orders,this.pages=o.data.pagination}).catch(o=>{i.fire(o.response.data.message)})},openModal(s,e){s==="new"?(this.tempCoupons={due_date:new Date().getTime()/1e3},this.isNew=!0,this.$refs.pModal.openModal()):s==="edit"?(this.tempCoupons={...e},this.isNew=!1,this.$refs.pModal.openModal()):s==="delete"&&(this.tempCoupons={...e},this.modalDel.show())},updateCoupons(){let s=`${h}/api/${m}/admin/coupon`,e="post";this.isNew||(s=`${h}/api/${m}/admin/coupon/${this.tempCoupons.id}`,e="put"),c[e](s,{data:this.tempCoupons}).then(o=>{i.fire(o.data.message),this.getCoupons(),this.$refs.pModal.closeModal(),this.tempCoupons={}}).catch(o=>{i.fire(o.response.data.message)})},delCoupons(){const s=`${this.apiUrl}/api/${this.apiPath}/admin/order/${this.tempCoupons.id}`;c.delete(s).then(e=>{i.fire(e.data.message),this.modalDel.hide(),this.getCoupons()}).catch(e=>{i.fire(e.response.data.message)})}},mounted(){this.getOrder(),this.modalDel=new C(this.$refs.delProductModal)},components:{pagination:y}},V={class:"container"},D=t("div",{class:"text-end mt-4"},null,-1),k={class:"table mt-4"},E=t("thead",null,[t("tr",null,[t("th",{width:"120"},"訂單建立日期"),t("th",{width:"120"},"訂購人"),t("th",{width:"120"},"訂購品項"),t("th",{width:"120"},"應付金額"),t("th",{width:"150"},"是否付款"),t("th",{width:"80"}," 編輯 ")])],-1),T=["textContent"],L={class:"list-unstyled"},N={key:0,class:"text-success"},S={key:1},A=t("td",null,[t("div",{class:"btn-group"})],-1),O={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},R={class:"modal-dialog"},B={class:"modal-content border-0"},I=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除優惠卷")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),U={class:"modal-body"},j={class:"text-danger"},F={class:"modal-footer"},H=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function q(s,e,o,J,p,_){const b=$("pagination");return n(),d(u,null,[t("div",V,[D,t("table",k,[E,t("tbody",null,[(n(!0),d(u,null,g(p.orders,a=>(n(),d("tr",{key:a.id},[t("td",null,l(a.create_at),1),t("td",null,[a.user?(n(),d("span",{key:0,textContent:l(a.user.name)},null,8,T)):v("",!0)]),t("td",null,[t("ul",L,[(n(!0),d(u,null,g(a.products,r=>(n(),d("li",{key:r.id},l(r.product.title)+" 數量："+l(r.qty)+" "+l(r.product.unit),1))),128))])]),t("td",null,l(a.total),1),t("td",null,[a.is_paid?(n(),d("span",N,"已付款")):(n(),d("span",S,"未付款"))]),A]))),128))])]),w(b,{pages:p.pages,"get-coupons":s.getCoupons},null,8,["pages","get-coupons"])]),t("div",O,[t("div",R,[t("div",B,[I,t("div",U,[f(" 是否刪除 "),t("strong",j,l(p.tempCoupons.title),1),f(" 商品(刪除後將無法恢復)。 ")]),t("div",F,[H,t("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...a)=>_.delCoupons&&_.delCoupons(...a))}," 確認刪除 ")])])])],512)],64)}const Y=M(P,[["render",q]]);export{Y as default};
