import{a as c}from"./axios-L6U4YIEh.js";import{M as f}from"./bootstrap.esm-TTjMTX3M.js";import{p as C}from"./PaginationComponents-fqhEhxWj.js";import{_ as y,c as l,b as t,F as p,aV as _,d as M,e as g,t as n,r as $,o as d,J as v}from"./index-u5xObLHv.js";var w={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_PATH:"junapi",BASE_URL:"/Aromatherapy-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:u,VITE_PATH:h}=w,x={data(){return{orders:[],tempCoupons:{},pages:{},modalProduct:null,modalDel:null,isNew:!1}},methods:{getOrder(s=1){const e=`${u}/api/${h}/admin/orders?page=${s}`;c.get(e).then(o=>{console.log(o),this.orders=o.data.orders,this.pages=o.data.pagination}).catch(o=>{alert(o.message)})},openModal(s,e){s==="new"?(this.tempCoupons={due_date:new Date().getTime()/1e3},this.isNew=!0,this.$refs.pModal.openModal()):s==="edit"?(this.tempCoupons={...e},this.isNew=!1,this.$refs.pModal.openModal()):s==="delete"&&(this.tempCoupons={...e},this.modalDel.show())},updateCoupons(){let s=`${u}/api/${h}/admin/coupon`,e="post";this.isNew||(s=`${u}/api/${h}/admin/coupon/${this.tempCoupons.id}`,e="put"),c[e](s,{data:this.tempCoupons}).then(o=>{console.log(o.message),alert(o.data.message),this.getCoupons(),this.$refs.pModal.closeModal(),this.tempCoupons={}}).catch(o=>{console.log(o),alert(o.message)})},delCoupons(){const s=`${this.apiUrl}/api/${this.apiPath}/admin/order/${this.tempCoupons.id}`;c.delete(s).then(e=>{alert(e.data.message),this.modalDel.hide(),this.getCoupons()}).catch(e=>{alert(e.data.message)})}},mounted(){this.getOrder(),this.modalDel=new f(this.$refs.delProductModal)},components:{pagination:C}},P={class:"container"},V=t("div",{class:"text-end mt-4"},null,-1),D={class:"table mt-4"},k=t("thead",null,[t("tr",null,[t("th",{width:"120"},"訂單建立日期"),t("th",{width:"120"},"訂購人"),t("th",{width:"120"},"訂購品項"),t("th",{width:"120"},"應付金額"),t("th",{width:"150"},"是否付款"),t("th",{width:"80"}," 編輯 ")])],-1),E=["textContent"],T={class:"list-unstyled"},L={key:0,class:"text-success"},N={key:1},A=t("td",null,[t("div",{class:"btn-group"})],-1),O={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},R={class:"modal-dialog"},B={class:"modal-content border-0"},I=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除優惠卷")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),S={class:"modal-body"},U={class:"text-danger"},j={class:"modal-footer"},F=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function H(s,e,o,q,r,m){const b=$("pagination");return d(),l(p,null,[t("div",P,[V,t("table",D,[k,t("tbody",null,[(d(!0),l(p,null,_(r.orders,a=>(d(),l("tr",{key:a.id},[t("td",null,n(a.create_at),1),t("td",null,[a.user?(d(),l("span",{key:0,textContent:n(a.user.name)},null,8,E)):v("",!0)]),t("td",null,[t("ul",T,[(d(!0),l(p,null,_(a.products,i=>(d(),l("li",{key:i.id},n(i.product.title)+" 數量："+n(i.qty)+" "+n(i.product.unit),1))),128))])]),t("td",null,n(a.total),1),t("td",null,[a.is_paid?(d(),l("span",L,"已付款")):(d(),l("span",N,"未付款"))]),A]))),128))])]),M(b,{pages:r.pages,"get-coupons":s.getCoupons},null,8,["pages","get-coupons"])]),t("div",O,[t("div",R,[t("div",B,[I,t("div",S,[g(" 是否刪除 "),t("strong",U,n(r.tempCoupons.title),1),g(" 商品(刪除後將無法恢復)。 ")]),t("div",j,[F,t("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...a)=>m.delCoupons&&m.delCoupons(...a))}," 確認刪除 ")])])])],512)],64)}const Q=y(x,[["render",H]]);export{Q as default};
