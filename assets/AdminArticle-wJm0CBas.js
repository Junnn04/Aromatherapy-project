import{a as u}from"./axios-L6U4YIEh.js";import{M as v,p as k}from"./PaginationComponents-jJpgWGfX.js";import{_ as y,o as c,c as n,b as t,t as h,j as r,v as p,n as $,F as b,g as P,d as f,e as A,r as g}from"./index-SlvrNoUn.js";const V={props:["isNew","tempArticle","updateArticle"],data(){return{modalArticle:null,editArticle:{},create_at:""}},watch:{article(){this.editArticle=this.tempArticle;const i=new Date(this.editArticle.create_at*1e3).toISOString().split("T");[this.create_at]=i},create_at(){this.editArticle.create_at=Math.floor(new Date(this.create_at)/1e3)}},methods:{openModal(){this.modalArticle.show()},closeModal(){this.modalArticle.hide()}},mounted(){this.modalArticle=new v(this.$refs.articleModal),this.editArticle=this.tempArticle}},D={id:"articleModal",ref:"articleModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},C={class:"modal-dialog modal-xl"},T={class:"modal-content border-0"},U={class:"modal-header bg-dark text-white"},E={id:"productModalLabel",class:"modal-title"},L={key:0},N={key:1},S=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),I={class:"modal-body"},R={class:"row"},B={class:"col-sm-8"},j={class:"mb-3"},O=t("label",{for:"title",class:"form-label"},"標題",-1),F={class:"row"},H={class:"mb-3 col-md-6"},q=t("label",{for:"author",class:"form-label"},"作者",-1),z={class:"mb-3 col-md-6"},G=t("label",{for:"create_at",class:"form-label"},"文章建立日期",-1),J={class:"mb-3"},K=t("label",{for:"description",class:"form-label"},"文章描述",-1),Q=t("label",{for:"description",class:"form-label"},"文章內容",-1),W={class:"mb-3"},X={class:"form-check"},Y=t("label",{class:"form-check-label",for:"isPublic"},"是否公開",-1),Z={class:"modal-footer"},tt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function et(i,e,l,M,s,d){return c(),n("div",D,[t("div",C,[t("div",T,[t("div",U,[t("h5",E,[l.isNew?(c(),n("span",L,"新增文章")):(c(),n("span",N,"編輯文章"))]),S]),t("div",I,[t("div",R,[t("pre",null,"    "+h(l.tempArticle)+`
    `,1),t("div",B,[t("div",j,[O,r(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[0]||(e[0]=o=>s.editArticle.title=o)},null,512),[[p,s.editArticle.title]])]),t("div",F,[t("div",H,[q,r(t("input",{id:"percent",type:"text",min:"0",class:"form-control",placeholder:"請輸入作者","onUpdate:modelValue":e[1]||(e[1]=o=>s.editArticle.author=o)},null,512),[[p,s.editArticle.author]])]),t("div",z,[G,r(t("input",{id:"create_at",type:"date",class:"form-control",placeholder:"文章建立日期","onUpdate:modelValue":e[2]||(e[2]=o=>s.create_at=o)},null,512),[[p,s.create_at]])])]),t("div",J,[K,r(t("textarea",{type:"text",class:"form-control",id:"description","onUpdate:modelValue":e[3]||(e[3]=o=>s.editArticle.description=o),placeholder:"請輸入文章描述"},null,512),[[p,s.editArticle.description]])]),Q,r(t("textarea",{type:"text",class:"form-control",id:"description","onUpdate:modelValue":e[4]||(e[4]=o=>s.editArticle.content=o),placeholder:"請輸入文章內容"},null,512),[[p,s.editArticle.content]]),t("div",W,[t("div",X,[r(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=o=>s.editArticle.isPublic=o),id:"isPublic"},null,512),[[$,s.editArticle.isPublic]]),Y])])])])]),t("div",Z,[tt,t("button",{type:"button",class:"btn btn-primary",onClick:e[6]||(e[6]=(...o)=>l.updateArticle&&l.updateArticle(...o))}," 確認 ")])])])],512)}const lt=y(V,[["render",et]]);var st={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_PATH:"junapi",BASE_URL:"/Aromatherapy-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:m,VITE_PATH:_}=st,ot={data(){return{articles:[],tempArticle:{},pages:{},modalProduct:null,modalDel:null,isNew:!1}},methods:{getArticle(i=1){const e=`${m}/api/${_}/admin/articles?page=${i}`;console.log(e),u.get(e).then(l=>{console.log(l),this.articles=l.data.articles,this.pages=l.data.pagination}).catch(l=>{alert(l.message)})},openModal(i,e){i==="new"?(this.tempArticle={create_at:new Date().getTime()/1e3},this.isNew=!0,this.$refs.pModal.openModal()):i==="edit"?(this.tempArticle={...e},this.isNew=!1,this.$refs.pModal.openModal()):i==="delete"&&(this.tempArticle={...e},this.modalDel.show())},updateArticle(){let i=`${m}/api/${_}/admin/article`,e="post";this.isNew||(i=`${m}/api/${_}/admin/article/${this.tempArticle.id}`,e="put"),u[e](i,{data:this.tempArticle}).then(l=>{console.log(l.message),alert(l.data.message),this.getArticle(),this.$refs.pModal.closeModal(),this.tempArticle={}}).catch(l=>{console.log(l),alert(l.message)})},delArticle(){const i=`${m}/api/${_}/admin/article/${this.tempArticle.id}`;u.delete(i).then(e=>{alert(e.data.message),this.modalDel.hide(),this.getArticle()}).catch(e=>{alert(e.data.message)})}},mounted(){this.getArticle(),this.modalDel=new v(this.$refs.delProductModal)},components:{pagination:k,articleModal:lt}},it={class:"container"},at={class:"text-end mt-4"},dt={class:"table mt-4"},ct=t("thead",null,[t("tr",null,[t("th",{width:"120"},"標題"),t("th",{width:"80"},"作者"),t("th",{width:"80"},"建立時間"),t("th",{width:"200"},"內容描述"),t("th",{width:"80"},"是否上傳"),t("th",{width:"80"}," 編輯 ")])],-1),nt={key:0,class:"text-success"},rt={key:1},ht={class:"btn-group"},pt=["onClick"],mt=["onClick"],_t={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},ut={class:"modal-dialog"},bt={class:"modal-content border-0"},ft=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除優惠卷")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),At={class:"modal-body"},gt={class:"text-danger"},vt={class:"modal-footer"},yt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Mt(i,e,l,M,s,d){const o=g("pagination"),w=g("article-modal");return c(),n(b,null,[t("div",it,[t("div",at,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=a=>d.openModal("new"))}," 建立新文章 ")]),t("table",dt,[ct,t("tbody",null,[(c(!0),n(b,null,P(s.articles,a=>(c(),n("tr",{key:a.id},[t("td",null,h(a.title),1),t("td",null,h(a.author),1),t("td",null,h(a.create_at),1),t("td",null,h(a.description),1),t("td",null,[a.isPublic?(c(),n("span",nt,"已上傳")):(c(),n("span",rt,"未上傳"))]),t("td",null,[t("div",ht,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:x=>d.openModal("edit",a)}," 編輯 ",8,pt),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:x=>d.openModal("delete",a)}," 刪除 ",8,mt)])])]))),128))])]),f(o,{pages:s.pages,"get-article":d.getArticle},null,8,["pages","get-article"])]),f(w,{"temp-article":s.tempArticle,"update-article":d.updateArticle,ref:"pModal"},null,8,["temp-article","update-article"]),t("div",_t,[t("div",ut,[t("div",bt,[ft,t("div",At,[A(" 是否刪除 "),t("strong",gt,h(s.tempArticle.title),1),A(" 商品(刪除後將無法恢復)。 ")]),t("div",vt,[yt,t("button",{type:"button",class:"btn btn-danger",onClick:e[1]||(e[1]=(...a)=>d.delArticle&&d.delArticle(...a))}," 確認刪除 ")])])])],512)],64)}const $t=y(ot,[["render",Mt]]);export{$t as default};
