import{a as _,S as r}from"./sweetalert2.all-CRiE7WjR.js";import{M as $}from"./bootstrap.esm-HdDQryZc.js";import{_ as y,o,c as n,b as e,C as g,F as h,g as b,t as i,d as k,e as C,r as x,I as M}from"./index-ZW9AbQuS.js";const w={props:["pages","getOrder"]},P={"aria-label":"Page navigation example"},O={class:"pagination justify-content-center"},D=e("span",{"aria-hidden":"true"},"«",-1),V=[D],E=["onClick"],T=e("span",{"aria-hidden":"true"},"»",-1),N=[T];function L(a,t,s,v,c,u){return o(),n("nav",P,[e("ul",O,[e("li",{class:g(["page-item",{disabled:!s.pages.has_pre}]),style:{cursor:"pointer"}},[e("a",{class:"page-link","aria-label":"Previous",onClick:t[0]||(t[0]=l=>s.getOrder(s.pages.current_page-1))},V)],2),(o(!0),n(h,null,b(s.pages.total_pages,l=>(o(),n("li",{class:g(["page-item",{active:l===s.pages.current_page}]),style:{cursor:"pointer","background-color":"gray"},key:l+123},[e("a",{class:"page-link",onClick:d=>s.getOrder(l)},i(l),9,E)],2))),128)),e("li",{class:g(["page-item",{disabled:!s.pages.has_next}]),style:{cursor:"pointer"}},[e("a",{class:"page-link","aria-label":"Next",onClick:t[1]||(t[1]=l=>s.getOrder(s.pages.current_page+1))},N)],2)])])}const S=y(w,[["render",L]]);var A={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_PATH:"junapi",BASE_URL:"/Aromatherapy-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:m,VITE_PATH:f}=A,I={data(){return{orders:[],tempCoupons:{},pages:{},modalProduct:null,modalDel:null,isNew:!1}},methods:{getOrder(a=1){const t=`${m}/api/${f}/admin/orders?page=${a}`;_.get(t).then(s=>{this.orders=s.data.orders,this.pages=s.data.pagination}).catch(s=>{r.fire(s.response.data.message)})},openModal(a,t){a==="new"?(this.tempCoupons={due_date:new Date().getTime()/1e3},this.isNew=!0,this.$refs.pModal.openModal()):a==="edit"?(this.tempCoupons={...t},this.isNew=!1,this.$refs.pModal.openModal()):a==="delete"&&(this.tempCoupons={...t},this.modalDel.show())},updateCoupons(){let a=`${m}/api/${f}/admin/coupon`,t="post";this.isNew||(a=`${m}/api/${f}/admin/coupon/${this.tempCoupons.id}`,t="put"),_[t](a,{data:this.tempCoupons}).then(s=>{r.fire(s.data.message),this.getCoupons(),this.$refs.pModal.closeModal(),this.tempCoupons={}}).catch(s=>{r.fire(s.response.data.message)})},delCoupons(){const a=`${this.apiUrl}/api/${this.apiPath}/admin/order/${this.tempCoupons.id}`;_.delete(a).then(t=>{r.fire(t.data.message),this.modalDel.hide(),this.getCoupons()}).catch(t=>{r.fire(t.response.data.message)})}},mounted(){this.getOrder(),this.modalDel=new $(this.$refs.delProductModal)},components:{pagination:S}},R={class:"container"},B=e("div",{class:"text-end mt-4"},null,-1),U={class:"table mt-4"},j=e("thead",null,[e("tr",null,[e("th",{width:"120"},"訂單建立日期"),e("th",{width:"120"},"訂購人"),e("th",{width:"120"},"訂購品項"),e("th",{width:"120"},"應付金額"),e("th",{width:"150"},"是否付款"),e("th",{width:"80"},"編輯")])],-1),F=["textContent"],H={class:"list-unstyled"},q={key:0,class:"text-success"},z={key:1},G=e("td",null,[e("div",{class:"btn-group"})],-1),J={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},K={class:"modal-dialog"},Q={class:"modal-content border-0"},W=e("div",{class:"modal-header bg-danger text-white"},[e("h5",{id:"delProductModalLabel",class:"modal-title"},[e("span",null,"刪除優惠卷")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),X={class:"modal-body"},Y={class:"text-danger"},Z={class:"modal-footer"},ee=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function te(a,t,s,v,c,u){const l=x("pagination");return o(),n(h,null,[e("div",R,[B,e("table",U,[j,e("tbody",null,[(o(!0),n(h,null,b(c.orders,d=>(o(),n("tr",{key:d.id},[e("td",null,i(d.create_at),1),e("td",null,[d.user?(o(),n("span",{key:0,textContent:i(d.user.name)},null,8,F)):M("",!0)]),e("td",null,[e("ul",H,[(o(!0),n(h,null,b(d.products,p=>(o(),n("li",{key:p.id},i(p.product.title)+" 數量："+i(p.qty)+" "+i(p.product.unit),1))),128))])]),e("td",null,i(d.total),1),e("td",null,[d.is_paid?(o(),n("span",q,"已付款")):(o(),n("span",z,"未付款"))]),G]))),128))])]),k(l,{pages:c.pages,"get-order":u.getOrder},null,8,["pages","get-order"])]),e("div",J,[e("div",K,[e("div",Q,[W,e("div",X,[C(" 是否刪除 "),e("strong",Y,i(c.tempCoupons.title),1),C(" 商品(刪除後將無法恢復)。 ")]),e("div",Z,[ee,e("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=(...d)=>u.delCoupons&&u.delCoupons(...d))}," 確認刪除 ")])])])],512)],64)}const ne=y(I,[["render",te]]);export{ne as default};
