import{a as _,S as c}from"./sweetalert2.all-j9gesYv3.js";import{M as v}from"./bootstrap.esm-yIA58xZk.js";import{_ as y,o,c as n,b as t,n as g,F as h,g as b,t as i,d as k,e as C,r as x,I as M}from"./index-vVl8uK9N.js";const w={props:["pages","getOrder"]},D={"aria-label":"Page navigation example"},P={class:"pagination justify-content-center"},O=t("span",{"aria-hidden":"true"},"«",-1),S=[O],V=["onClick"],E=t("span",{"aria-hidden":"true"},"»",-1),T=[E];function N(a,e,s,$,u,r){return o(),n("nav",D,[t("ul",P,[t("li",{class:g(["page-item",{disabled:!s.pages.has_pre}]),style:{cursor:"pointer"}},[t("a",{class:"page-link","aria-label":"Previous",onClick:e[0]||(e[0]=l=>s.getOrder(s.pages.current_page-1))},S)],2),(o(!0),n(h,null,b(s.pages.total_pages,l=>(o(),n("li",{class:g(["page-item",{active:l===s.pages.current_page}]),style:{cursor:"pointer","background-color":"gray"},key:l+123},[t("a",{class:"page-link",onClick:d=>s.getOrder(l)},i(l),9,V)],2))),128)),t("li",{class:g(["page-item",{disabled:!s.pages.has_next}]),style:{cursor:"pointer"}},[t("a",{class:"page-link","aria-label":"Next",onClick:e[1]||(e[1]=l=>s.getOrder(s.pages.current_page+1))},T)],2)])])}const L=y(w,[["render",N]]);var A={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_PATH:"junapi",BASE_URL:"/Aromatherapy-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:m,VITE_PATH:f}=A,I={data(){return{orders:[],tempCoupons:{},pages:{},modalProduct:null,modalDel:null,isNew:!1}},methods:{getOrder(a=1){const e=`${m}/api/${f}/admin/orders?page=${a}`;_.get(e).then(s=>{this.orders=s.data.orders,this.pages=s.data.pagination}).catch(s=>{c.fire(s.response.data.message)})},formatDate(a){const e=new Date(a*1e3);return`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`},openModal(a,e){a==="new"?(this.tempCoupons={due_date:new Date().getTime()/1e3},this.isNew=!0,this.$refs.pModal.openModal()):a==="edit"?(this.tempCoupons={...e},this.isNew=!1,this.$refs.pModal.openModal()):a==="delete"&&(this.tempCoupons={...e},this.modalDel.show())},updateCoupons(){let a=`${m}/api/${f}/admin/coupon`,e="post";this.isNew||(a=`${m}/api/${f}/admin/coupon/${this.tempCoupons.id}`,e="put"),_[e](a,{data:this.tempCoupons}).then(s=>{c.fire(s.data.message),this.getCoupons(),this.$refs.pModal.closeModal(),this.tempCoupons={}}).catch(s=>{c.fire(s.response.data.message)})},delCoupons(){const a=`${this.apiUrl}/api/${this.apiPath}/admin/order/${this.tempCoupons.id}`;_.delete(a).then(e=>{c.fire(e.data.message),this.modalDel.hide(),this.getCoupons()}).catch(e=>{c.fire(e.response.data.message)})}},mounted(){this.getOrder(),this.modalDel=new v(this.$refs.delProductModal)},components:{pagination:L}},R={class:"container"},B=t("div",{class:"text-end mt-4"},null,-1),U={class:"table mt-4"},j=t("thead",null,[t("tr",null,[t("th",{width:"120"},"訂單建立日期"),t("th",{width:"120"},"訂購人"),t("th",{width:"120"},"訂購品項"),t("th",{width:"120"},"應付金額"),t("th",{width:"150"},"是否付款"),t("th",{width:"80"},"編輯")])],-1),F=["textContent"],H={class:"list-unstyled"},q={key:0,class:"text-success"},z={key:1},Y=t("td",null,[t("div",{class:"btn-group"})],-1),G={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},J={class:"modal-dialog"},K={class:"modal-content border-0"},Q=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除優惠卷")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),W={class:"modal-body"},X={class:"text-danger"},Z={class:"modal-footer"},tt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function et(a,e,s,$,u,r){const l=x("pagination");return o(),n(h,null,[t("div",R,[B,t("table",U,[j,t("tbody",null,[(o(!0),n(h,null,b(u.orders,d=>(o(),n("tr",{key:d.id},[t("td",null,i(r.formatDate(d.create_at)),1),t("td",null,[d.user?(o(),n("span",{key:0,textContent:i(d.user.name)},null,8,F)):M("",!0)]),t("td",null,[t("ul",H,[(o(!0),n(h,null,b(d.products,p=>(o(),n("li",{key:p.id},i(p.product.title)+" 數量："+i(p.qty)+" "+i(p.product.unit),1))),128))])]),t("td",null,i(d.total),1),t("td",null,[d.is_paid?(o(),n("span",q,"已付款")):(o(),n("span",z,"未付款"))]),Y]))),128))])]),k(l,{pages:u.pages,"get-order":r.getOrder},null,8,["pages","get-order"])]),t("div",G,[t("div",J,[t("div",K,[Q,t("div",W,[C(" 是否刪除 "),t("strong",X,i(u.tempCoupons.title),1),C(" 商品(刪除後將無法恢復)。 ")]),t("div",Z,[tt,t("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...d)=>r.delCoupons&&r.delCoupons(...d))}," 確認刪除 ")])])])],512)],64)}const nt=y(I,[["render",et]]);export{nt as default};
